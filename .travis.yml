language: groovy

jdk:
- oraclejdk7

before_script:
- "export DISPLAY=:99.0" 
- "sh -e /etc/init.d/xvfb start"

before_install:
- curl -s get.sdkman.io | bash
- source "$HOME/.sdkman/bin/sdkman-init.sh"
- echo sdkman_auto_answer=true > ~/.sdkman/etc/config
- source "/home/travis/.sdkman/bin/sdkman-init.sh"
- sdk install grails 3.2.3 
- chmod +x gradlew

branches:
  only:
    - master

script: grails -Dgeb.env=firefox test-app functional:cucumber --non-interactive --stacktrace
script: grails -Dgeb.env=firefox war functional:cucumber --non-interactive --stacktrace

 deploy:
      - provider: s3
        â‹® # rest of S3 deployment for MyApp.zip
      - provider: codedeploy
        access_key_id: "YOUR AWS ACCESS KEY"
        secret_access_key: "YOUR AWS SECRET KEY"
        bucket: "S3 Bucket"
        key: latest/MyApp.zip
        application: MyApp
        deployment_group: MyDeploymentGroup
